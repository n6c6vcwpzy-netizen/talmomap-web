<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>탈모맵</title>
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>💊</text></svg>">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="layout.css">
  <link rel="stylesheet" href="components.css">
  <link rel="stylesheet" href="responsive.css">
  
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=0d2e650cecb8f7b3f79a14826495b876&libraries=services"></script>
</head>
<body>
<div class="app-container">
  <!-- 왼쪽 사이드바: 메뉴 및 구독 상태 표시 -->
  <aside class="sidebar">
    <div class="logo">
      <span class="pill">💊</span> 탈모맵
    </div>
    <div class="trial-info">
      <div class="trial-banner">
        <span class="clock">⏱️</span>
        <div class="time">남은 시간: 23시간 45분</div>
      </div>
    </div>
    <nav class="menu">
      <button class="menu-item active" data-page="map" title="지도" aria-label="지도"><i class="fas fa-map"></i><span class="menu-label">지도</span></button>
      <button class="menu-item" data-page="list" title="약국" aria-label="약국"><i class="fas fa-list"></i><span class="menu-label">약국</span></button>
      <button class="menu-item" data-page="activity" title="활동" aria-label="활동"><i class="fas fa-history"></i><span class="menu-label">활동</span></button>
      <button class="menu-item" data-page="subscribe" title="구독" aria-label="구독"><i class="fas fa-crown"></i><span class="menu-label">구독</span></button>
    </nav>
  </aside>

  <!-- 메인 컨텐츠 영역 -->
  <main class="main-content">
    <!-- 지도 페이지 (기본) -->
    <section id="page-map" class="page active">
      <div class="search-bar-container">
        <div class="search-wrapper">
          <input type="text" class="search-bar" placeholder="약국이나 약 이름 검색...">
          <button class="mic-btn"><i class="fas fa-microphone"></i></button>
        </div>
        <div style="margin-top:10px; text-align:center;">
          <button id="find-nearby-btn" style="padding:10px 24px; border-radius:20px; background:#4a90e2; color:white; border:none; font-size:16px; font-weight:bold; box-shadow:0 2px 8px rgba(74,144,226,0.08); cursor:pointer;">주변 약국 찾기</button>
        </div>
      </div>
      <div id="map"></div>
      <aside class="side-panel" id="side-panel">
        <button class="panel-close" id="panel-close">×</button>
        <div class="panel-tabs">
          <div id="panel-list" class="panel-section"></div>
          <div id="panel-detail" class="panel-section" style="display:none;">
            <div class="panel-header">
              <h3 id="panel-detail-title"></h3>
              <div class="panel-actions"><button id="panel-detail-back" class="panel-action-btn">목록</button></div>
            </div>
            <div style="padding:8px 0 0 0;">
              <p id="panel-detail-address" style="color:#666;margin-bottom:6px;"></p>
              <p id="panel-detail-phone" style="color:#666;margin-bottom:6px;"></p>
              <p id="panel-detail-hours" style="color:#666;margin-bottom:6px;font-size:13px;"></p>
              <div style="display:flex;gap:8px;margin-top:8px;margin-bottom:6px;">
                <button id="panel-kakao-view" class="kakao-btn">카카오 지도 보기</button>
                <button class="naver-btn" id="panel-naver-btn">NAVER 지도 보기</button>
              </div>
            </div>
          </div>
          <div id="panel-activity" class="panel-section" style="display:none;">
            <div class="panel-header">
              <h3><i class="fas fa-history"></i> 최근 활동</h3>
              <div class="panel-actions"><button id="clear-activity-btn" class="panel-action-btn danger">삭제</button></div>
            </div>
            <div class="panel-loader" style="display:none;">로딩 중...</div>
            <div class="panel-empty" style="padding:20px;text-align:center;color:#888;"><i class="fas fa-inbox" style="font-size:22px;margin-bottom:8px;display:block;"></i>활동이 없습니다</div>
            <ul id="activity-list" style="list-style:none;padding-left:0;margin-top:12px;"></ul>
          </div>
          <div id="panel-subscribe" class="panel-section" style="display:none;">
            <div class="panel-header">
              <h3><i class="fas fa-crown"></i> 구독</h3>
            </div>
            <div id="panel-sub-status" style="padding:12px;background:#f3f4f6;border-radius:8px;margin-bottom:12px;">상태: 로딩 중...</div>
            <button id="panel-subscribe-btn" style="width:100%;padding:14px;background:#4a90e2;color:white;border:none;border-radius:10px;cursor:pointer;font-weight:bold;">구독하기</button>
          </div>
        </div>
      </aside>
    </section>

    <!-- 활동 페이지 -->
    <section id="page-activity" class="page">
      <h2 style="padding:16px;margin:0;">활동 내역</h2>
      <p style="padding:16px;margin:0;">최근 방문 약국과 검색 기록이 표시됩니다.</p>
      <div id="page-activity-list" style="padding:16px;"></div>
    </section>

    <!-- 구독 페이지 -->
    <section id="page-subscribe" class="page">
      <h2 style="padding:16px;margin:0;">구독</h2>
      <p style="padding:16px;margin:0;">990원/월로 무제한 이용 가능</p>
    </section>
  </main>
</div>

<!-- 위치정보 수집·이용 동의 모달 -->
<div id="location-consent-modal" class="consent-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="consent-title" aria-describedby="consent-desc">
  <div class="consent-card">
    <div class="consent-header">
      <div class="consent-badge">필수 동의</div>
      <h2 id="consent-title">위치정보 수집·이용 동의</h2>
      <p id="consent-desc" class="consent-desc">탈모맵은 주변 약국 검색을 위해 위치정보를 수집·이용합니다. 동의하지 않으면 내 위치 기능이 제한됩니다.</p>
    </div>
    <ul class="consent-list">
      <li>수집 항목: 위치정보(위도/경도)</li>
      <li>이용 목적: 주변 약국 검색 및 지도 표시</li>
      <li>보관 기간: 목적 달성 즉시 파기</li>
    </ul>
    <div class="consent-actions">
      <button id="consent-decline-btn" class="consent-btn ghost">거부</button>
      <button id="consent-accept-btn" class="consent-btn primary">동의</button>
    </div>
    <p class="consent-footnote">동의는 최초 1회만 요청되며, 설정에서 변경할 수 있습니다.</p>
  </div>
</div>

<!-- 구독 상태 표시 패널 -->
<div id="subscription-panel" style="display:none;">
  <div id="panel-trial-banner" class="trial-banner" style="display:none;">
    <span class="clock">⏱️</span>
    <div class="time-text">남은 시간: <strong id="panel-trial-time">0시간</strong></div>
  </div>
  <div id="panel-status" class="status-card">
    <h2>현재 상태</h2>
    <p class="status-text" id="panel-status-text">구독되지 않음</p>
  </div>
  <div id="panel-subscribe-card" class="subscribe-card">
    <div class="avatar">💊</div>
    <h3>탈모맵 구독</h3>
    <div class="price"><strong>990원</strong> <span style="font-size:14px;color:#666">/월</span></div>
    <p class="muted" style="margin-top:10px;">이 앱을 이용하려면 월 990원 구독이 필요합니다. <strong>1일 무료 체험 제공</strong></p>
    <button id="subscribe-btn" class="cta">구독하기 990원/월</button>
  </div>
  <div id="panel-payment-methods" style="padding-top:12px;">
    <h3 style="margin:8px 0 12px 0;font-weight:bold;">결제 수단 선택</h3>
    <div class="payment-methods">
      <button class="pm-kakao">카카오페이</button>
      <button class="pm-card"><i class="fas fa-credit-card"></i> 카드</button>
      <button class="pm-apple"><i class="fab fa-apple"></i> Apple</button>
    </div>
  </div>
  <div id="panel-management" style="display:none;margin-top:12px;">
    <button id="change-payment-btn" class="manage-btn">결제 수단 변경</button>
    <button id="cancel-subscribe-btn" class="manage-btn danger">구독 취소</button>
  </div>
  <p class="notice" style="margin-top:12px;color:#666;font-size:13px;">구독은 언제든지 취소할 수 있습니다.</p>
</div>

<!-- 토스트 알림 -->
<div id="toast" class="toast" aria-live="polite" style="display:none;"></div>

<!-- 약국 상세 팝업 -->
<div id="pharmacy-popup">
  <div class="popup-header">
    <h2 id="popup-title">약국 정보</h2>
    <button class="popup-close" id="popup-close">×</button>
  </div>
  <p id="popup-address"></p>
  <p id="popup-phone"></p>
  <p id="popup-hours" style="color:#666;margin-bottom:12px;font-size:13px;"></p>
  <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;">
    <button class="naver-btn" id="naver-map-btn">NAVER 지도 보기</button>
    <button id="popup-kakao-view" class="kakao-btn">카카오 지도 보기</button>
  </div>
  <div id="pharmacy-comments-section" style="margin-top:6px;">
    <h3 style="font-size:18px;margin:0 0 6px;">댓글</h3>
    <div id="pharmacy-comments-list" style="min-height:0;margin:0 0 6px;"></div>
    <div style="display:flex;gap:8px;align-items:flex-end;">
      <textarea id="pharmacy-comment-input" placeholder="댓글을 입력하세요" style="flex:1;resize:vertical;min-height:32px;padding:8px;border-radius:8px;border:1px solid #ddd;"></textarea>
      <button id="pharmacy-comment-submit" style="padding:8px 16px;border-radius:8px;background:#4a90e2;color:white;border:none;font-weight:bold;">등록</button>
    </div>
  </div>
</div>

<script src="config.js"></script>
  
  <script src="storage.js"></script>
  <script src="helpers.js"></script>
  <script src="api.js"></script>
  
  <script src="toast.js"></script>
  <script src="panel.js"></script>
  
  <script src="map.js"></script>
  
  <script src="pharmacy.js"></script>
  <script src="consent.js"></script>
  
  <script src="userLocation.js"></script>
  <script src="pharmacyMarker.js"></script>
  <script src="pharmacySearch.js"></script>
  <script src="pharmacyPopup.js"></script>
  <script src="panelInteraction.js"></script>
  <script src="mapAnimation.js"></script>
  <script src="location.js"></script>
  <script src="activity.js"></script>
  <script src="subscription.js"></script>
  
  <script src="main.js"></script>
</body>
</html>
